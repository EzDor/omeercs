workflow_name: campaign.build.minimal
version: "1.0.0"
description: Minimal campaign build for reference implementation testing - 4 steps

steps:
  # Step 1: Game Configuration
  - step_id: game_config
    skill_id: game_config_from_template
    depends_on: []
    description: Generate game configuration from template
    input_selector:
      template_id:
        source: trigger
        path: template_id
      theme:
        source: trigger
        path: theme
      difficulty:
        source: trigger
        path: difficulty
      color_scheme:
        source: trigger
        path: color_scheme
      copy:
        source: trigger
        path: copy
    cache_policy:
      enabled: true
      scope: global
    retry_policy:
      max_attempts: 2
      backoff_ms: 1000

  # Step 2: Background Music
  - step_id: bgm
    skill_id: generate_bgm_track
    depends_on: []
    description: Generate background music track
    input_selector:
      style:
        source: trigger
        path: audio.style
      duration_sec:
        source: trigger
        path: audio.duration_sec
      custom_prompt:
        source: trigger
        path: audio.prompt
      loopable:
        source: constants
        value: true
    cache_policy:
      enabled: true
      scope: global
    retry_policy:
      max_attempts: 2
      backoff_ms: 2000

  # Step 3: Game Bundle
  - step_id: bundle_game
    skill_id: bundle_game_template
    depends_on: [game_config, bgm]
    description: Bundle game template with assets
    input_selector:
      game_config:
        source: step_output
        step_id: game_config
        path: data
      audio_uri:
        source: step_output
        step_id: bgm
        path: audio_uri
      template_id:
        source: trigger
        path: template_id
    cache_policy:
      enabled: true
      scope: run_only
    retry_policy:
      max_attempts: 2
      backoff_ms: 2000

  # Step 4: Campaign Manifest
  - step_id: manifest
    skill_id: assemble_campaign_manifest
    depends_on: [bundle_game]
    description: Assemble final campaign manifest with all assets
    input_selector:
      campaign_id:
        source: trigger
        path: campaign_id
      campaign_name:
        source: trigger
        path: campaign_name
      intro_video_uri:
        source: trigger
        path: intro_video_uri
      outcome_videos:
        source: trigger
        path: outcome_videos
      game_bundle_uri:
        source: step_output
        step_id: bundle_game
        path: data.bundle_uri
      button_config:
        source: trigger
        path: button_config
      rules:
        source: trigger
        path: rules
      branding:
        source: trigger
        path: branding
    cache_policy:
      enabled: false
      scope: run_only
    retry_policy:
      max_attempts: 1
      backoff_ms: 1000
